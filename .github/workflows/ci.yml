# name: CI/CD

# on:
#   push:
#     branches: [main]
#   pull_request:
#     branches: [main]

# jobs:
#   test:
#     runs-on: ubuntu-latest

#     services:
#       postgres:
#         image: postgres:14
#         env:
#           POSTGRES_PASSWORD: postgres
#         ports: ["5432:5432"]
#         options: >-
#           --health-cmd pg_isready
#           --health-interval 10s
#           --health-timeout 5s
#           --health-retries 5

#     steps:
#       - uses: actions/checkout@v3

#       - name: Set up Ruby
#         uses: ruby/setup-ruby@v1
#         with:
#           ruby-version: 3.2.2
#           bundler-cache: true

#       - name: Install dependencies
#         run: |
#           bundle install
#           yarn install

#       - name: Setup Database
#         env:
#           RAILS_ENV: test
#           DATABASE_URL: postgres://postgres:postgres@localhost:5432/test
#         run: |
#           bundle exec rails db:create
#           bundle exec rails db:schema:load

#       - name: Run tests
#         env:
#           RAILS_ENV: test
#           DATABASE_URL: postgres://postgres:postgres@localhost:5432/test
#         run: |
#           bundle exec rspec

#       - name: Run security checks
#         run: |
#           bundle exec brakeman -q -w2

#   deploy:
#     needs: test
#     if: github.ref == 'refs/heads/main'
#     runs-on: ubuntu-latest

#     steps:
#       - name: Deploy to production
#         # Add your deployment steps here

#         run: echo "Add your deployment steps here"
